{% extends 'base.html' %}
{% block users %}active{% endblock %}
{% block content %}
{% if keyword %} <h2>The result of searching: "{{ keyword }}"</h2> {% endif %}
{% if debug %} <h2>debug msg: "</h2><pre>{{ debug }}</pre> {% endif %}
<div id="table_div"></div>
{% endblock %}

{% block tailscript %}
    <script type='text/javascript' src='https://www.google.com/jsapi'></script>
    <script type='text/javascript'>
        google.load('visualization', '1', {packages:['table']});
        google.setOnLoadCallback(drawTable);
        function drawTable() {
            var data = new google.visualization.DataTable();
            {% for col in cols %}
                data.addColumn{{ col|safe }};
            {% endfor %}
            data.addRows({{ rows|safe }})
            
            var table = new google.visualization.Table($('#table_div')[0]);
            table.draw(data);


            {% if rowlinks %}
            var rowlinks = {{ rowlinks|safe }};
            function selectHandler(e)     {   
                var selection = table.getSelection()[0];
                if (selection.row != null) {
                    window.location = rowlinks[selection.row];
                }
            }
            google.visualization.events.addListener(table, 'select', selectHandler); 
            {% endif %}
        }
    </script>
{% endblock %}

